{"config":{"lang":["en"],"separator":"[\\s\\-]+","pipeline":["stopWordFilter"]},"docs":[{"location":"","title":"NShip","text":"<p>nship is a flexible and efficient deployment automation tool designed to streamline the execution of deployment jobs across multiple targets. It simplifies the configuration and execution of deployment workflows by providing structured job and target management.</p>"},{"location":"#features","title":"Features","text":"<ul> <li>Define deployment jobs with structured steps.</li> <li>Support for remote deployment targets with SSH authentication.</li> <li>Configuration management using YAML, JSON, TOML, TypeScript, JavaScript, Golang, or any command output.</li> <li>Built-in support for file copying, script execution, and Docker container management.</li> <li>Ansible Vault decryption support for handling secure credentials.</li> <li>Skipping unchanged steps for optimized execution.</li> <li>CLI-based execution with customizable environment loading.</li> </ul>"},{"location":"#getting-started","title":"Getting Started","text":""},{"location":"#installation","title":"Installation","text":"<p>You can install nship in several ways:</p>"},{"location":"#binary-releases","title":"Binary Releases","text":"<p>Download pre-built binaries for your platform from the GitHub Releases page.</p> <p>We provide binaries for:</p> <ul> <li> <p>Linux (x86_64, arm64)</p> </li> <li> <p>macOS (x86_64, arm64)</p> </li> <li> <p>Windows (x86_64, arm64)</p> </li> </ul>"},{"location":"#linux-package-managers","title":"Linux Package Managers","text":"<p>For Debian/Ubuntu:</p> <pre><code>curl -LO https://github.com/nickalie/nship/releases/download/v{version}/nship_{version}_linux_x86_64.deb\nsudo dpkg -i nship_{version}_linux_x86_64.deb\n</code></pre> <p>For RHEL/CentOS/Fedora:</p> <pre><code>curl -LO https://github.com/nickalie/nship/releases/download/v{version}/nship_{version}_linux_x86_64.rpm\nsudo rpm -i nship_{version}_linux_x86_64.rpm\n</code></pre> <p>For Alpine Linux:</p> <pre><code>curl -LO https://github.com/nickalie/nship/releases/download/v{version}/nship_{version}_linux_x86_64.apk\nsudo apk add --allow-untrusted nship_{version}_linux_x86_64.apk\n</code></pre>"},{"location":"#go-install","title":"Go Install","text":"<p>If you have Go installed:</p> <pre><code>go install github.com/nickalie/nship/cmd/nship@latest\n</code></pre>"},{"location":"#build-from-source","title":"Build from Source","text":"<p>To build nship from source:</p> <pre><code># Clone the repository\ngit clone https://github.com/nickalie/nship.git\ncd nship\n\n# Build the application\nmake build\n</code></pre>"},{"location":"#usage","title":"Usage","text":"<p>Run a deployment job using:</p> <pre><code>nship --config=config.yaml --job=deploy-app\n</code></pre> <p>Additional options:</p> <ul> <li><code>--config=&lt;path&gt;</code>: Path to the configuration file (default: <code>nship.yaml</code>).</li> <li><code>--job=&lt;name&gt;</code>: Name of the job to run.</li> <li><code>--env-file=&lt;path&gt;</code>: Path to an environment file (can be specified multiple times).</li> <li><code>--vault-password=&lt;password&gt;</code>: Password for decrypting Ansible Vault files.</li> <li><code>--no-skip</code>: Disable skipping unchanged steps.</li> <li><code>--version</code>: Show version information.</li> </ul>"},{"location":"#environment-files","title":"Environment Files","text":"<p>Environment files can be specified in several ways:</p> <pre><code># Single environment file\nnship --env-file=dev.env\n\n# Multiple environment files using multiple flags\nnship --env-file=dev.env --env-file=secrets.env\n</code></pre>"},{"location":"#configuration","title":"Configuration","text":"<p>nship offers exceptional flexibility in how you define your deployment configurations. Choose the format that best fits your workflow:</p>"},{"location":"#configuration-formats","title":"Configuration Formats","text":"<ul> <li>YAML/JSON/TOML: Simple, structured formats for static configurations</li> <li>TypeScript/JavaScript: Leverage the full power of a programming language with type safety, variables, and logic</li> <li>Golang: Use Go's strong typing and performance for complex configuration needs</li> <li>Command Output: Generate configurations dynamically using any script or command</li> </ul>"},{"location":"#dynamic-configuration-with-programming-languages","title":"Dynamic Configuration with Programming Languages","text":""},{"location":"#typescriptjavascript-benefits","title":"TypeScript/JavaScript Benefits","text":"<ul> <li>Type Safety: Catch configuration errors before runtime with TypeScript</li> <li>Code Reuse: Create functions for repeated configuration patterns</li> <li>Environment Handling: Programmatically include environment-specific settings</li> <li>Dynamic Generation: Generate configurations based on external data sources</li> </ul>"},{"location":"#golang-configuration-benefits","title":"Golang Configuration Benefits","text":"<ul> <li>Strong Typing: Ensure configuration correctness with Go's type system</li> <li>Builder Pattern: Use the builder API for cleaner configuration construction</li> <li>Performance: Generate complex configurations efficiently</li> <li>Direct Integration: Access Go libraries within your configuration</li> </ul>"},{"location":"#command-based-configuration","title":"Command-based Configuration","text":"<p>Command-based configurations provide maximum flexibility by letting you generate configurations dynamically:</p> <pre><code># Use output from any command as configuration\nnship --config=\"cmd:curl https://example.com/config\"\n\n# Generate environment-specific configurations\nnship --config=\"cmd:./generate-config.sh --env=production\"\n\n# Use database-driven configurations\nnship --config=\"cmd:python scripts/db_to_config.py\"\n</code></pre> <p>This approach enables: - CI/CD Integration: Generate configurations during pipeline execution - Centralized Management: Pull configurations from central repositories - Dynamic Settings: Include real-time system information in deployments</p>"},{"location":"#example-configurations","title":"Example Configurations","text":""},{"location":"#yaml-configuration","title":"YAML Configuration","text":"<pre><code>targets:\n  - name: production\n    host: prod.example.com\n    user: deploy\n    private_key: ~/.ssh/id_rsa\n\njobs:\n  - name: deploy-app\n    steps:\n      - run: echo \"Deploying application...\"\n      - copy:\n          local: ./app/\n          remote: /var/www/app/\n      - docker:\n          image: myapp:latest\n          name: myapp-container\n          ports: [\"8080:80\"]\n</code></pre>"},{"location":"#json-configuration","title":"JSON Configuration","text":"<pre><code>{\n  \"targets\": [\n    {\n      \"name\": \"production\",\n      \"host\": \"prod.example.com\",\n      \"user\": \"deploy\",\n      \"private_key\": \"~/.ssh/id_rsa\"\n    }\n  ],\n  \"jobs\": [\n    {\n      \"name\": \"deploy-app\",\n      \"steps\": [\n        {\n          \"run\": \"echo \\\"Deploying application...\\\"\"\n        },\n        {\n          \"copy\": {\n            \"local\": \"./app/\",\n            \"remote\": \"/var/www/app/\"\n          }\n        },\n        {\n          \"docker\": {\n            \"image\": \"myapp:latest\",\n            \"name\": \"myapp-container\",\n            \"ports\": [\"8080:80\"],\n            \"build\": {\n              \"context\": \"./app\",\n              \"args\": {\n                \"VERSION\": \"1.0.0\"\n              }\n            }\n          }\n        }\n      ]\n    }\n  ]\n}\n</code></pre>"},{"location":"#typescript-configuration","title":"TypeScript Configuration","text":"<pre><code>export default {\n  targets: [\n    { name: \"production\", host: \"prod.example.com\", user: \"deploy\", private_key: \"~/.ssh/id_rsa\" }\n  ],\n  jobs: [\n    {\n      name: \"deploy-app\",\n      steps: [\n        { run: \"echo \\\"Deploying application...\\\"\" },\n        { copy: { local: \"./app/\", remote: \"/var/www/app/\" } },\n        { docker: { image: \"myapp:latest\", name: \"myapp-container\", ports: [\"8080:80\"] } }\n      ]\n    }\n  ]\n};\n</code></pre>"},{"location":"#typescript-with-dynamic-configuration","title":"TypeScript with Dynamic Configuration","text":"<pre><code>// Example of dynamic configuration with TypeScript\nimport * as fs from 'fs';\n\n// Load environments from external file\nconst environments = JSON.parse(fs.readFileSync('./environments.json', 'utf8'));\n\n// Create reusable step patterns\nconst createDeploymentSteps = (appName: string, version: string) =&gt; [\n  { run: `echo \"Deploying ${appName} version ${version}...\"` },\n  { copy: { local: `./${appName}/`, remote: `/var/www/${appName}/` } },\n  { docker: { \n      image: `${appName}:${version}`, \n      name: `${appName}-container`,\n      ports: [\"8080:80\"] \n    }\n  }\n];\n\nexport default {\n  targets: environments.map(env =&gt; ({\n    name: env.name,\n    host: env.host,\n    user: env.user,\n    private_key: env.keyPath\n  })),\n  jobs: [\n    {\n      name: \"deploy-frontend\",\n      steps: createDeploymentSteps(\"frontend\", \"1.2.3\")\n    },\n    {\n      name: \"deploy-backend\",\n      steps: createDeploymentSteps(\"backend\", \"4.5.6\")\n    }\n  ]\n};\n</code></pre>"},{"location":"#golang-configuration","title":"Golang Configuration","text":"<pre><code>package main\n\nimport (\n    \"github.com/nickalie/nship/pkg/nship\"\n    \"log\"\n)\n\nfunc main() {\n    err := nship.NewBuilder().\n        AddTarget(&amp;nship.Target{\n            Host: \"prod.example.com\",\n            User: \"deploy\",\n            PrivateKey: \"~/.ssh/id_rsa\",\n        }).\n        AddJob(\"deploy-app\").\n        AddRunStep(\"echo 'Deploying application...'\").\n        AddCopyStep(\"./app/\", \"/var/www/app/\").\n        AddDockerStep(&amp;nship.DockerStep{\n            Image:    \"myapp:latest\",\n            Name:     \"myapp-container\",\n            Ports:    []string{\"8080:80\"},\n        }).\n        Print()\n\n    if err != nil {\n        log.Fatal(err)\n    }\n}\n</code></pre>"},{"location":"#example-configuration-toml","title":"Example Configuration (TOML)","text":"<pre><code>[[targets]]\nname = \"production\"\nhost = \"prod.example.com\"\nuser = \"deploy\"\nprivate_key = \"~/.ssh/id_rsa\"\n\n[[jobs]]\nname = \"deploy-app\"\n\n[[jobs.steps]]\nrun = \"echo 'Deploying application...'\"\n\n[[jobs.steps.copy]]\nlocal = \"./app/\"\nremote = \"/var/www/app/\"\n\n[[jobs.steps.docker]]\nimage = \"myapp:latest\"\nname = \"myapp-container\"\nports = [\"8080:80\"]\n</code></pre>"},{"location":"#deployment-steps","title":"Deployment Steps","text":""},{"location":"#run-step","title":"Run Step","text":"<p>Executes a shell command:</p> <pre><code>- run: |\n    echo \"Starting deployment...\"\n    mkdir -p /var/www/app\n    cp -r ./app/* /var/www/app/\n    systemctl restart myapp\n\n- run: systemctl restart myapp\n</code></pre>"},{"location":"#copy-step","title":"Copy Step","text":"<p>Copies files to a remote target. Identical files are not copied to optimize performance:</p> <pre><code>- copy:\n    local: ./config/\n    remote: /etc/myapp/\n</code></pre>"},{"location":"#docker-step","title":"Docker Step","text":"<p>Runs a Docker container on the target. If the container already exists, it will be removed before starting a new instance:</p> <pre><code>- docker:\n    image: nginx:latest\n    name: web-server\n    ports: [\"80:80\"]\n    environment:\n      - \"ENV_VAR=value\"\n    volumes:\n      - \"/host/path:/container/path\"\n    labels:\n      app: \"my-web-app\"\n    networks:\n      - \"custom-network\"\n    restart: \"always\"\n    command:\n      - \"npm start\"\n    build:\n      context: ./path/to/directory/with/dockerfile\n      args:\n        VERSION: \"1.0.0\"\n        DEBUG: \"true\"\n</code></pre>"},{"location":"#supported-keys-in-docker-step","title":"Supported Keys in Docker Step","text":"<ul> <li><code>image</code> (string, required): Docker image to use.</li> <li><code>name</code> (string, required): Name of the Docker container.</li> <li><code>ports</code> (list of strings, optional): List of port mappings in the format <code>host:container</code>.</li> <li><code>environment</code> (list of strings, optional): List of environment variables.</li> <li><code>volumes</code> (list of strings, optional): List of volume mounts in the format <code>host_path:container_path</code>.</li> <li><code>labels</code> (map of key-value pairs, optional): Labels to assign to the container.</li> <li><code>networks</code> (list of strings, optional): List of network names to connect the container.</li> <li><code>restart</code> (string, optional): Restart policy (<code>no</code>, <code>on-failure</code>, <code>always</code>, <code>unless-stopped</code>).</li> <li><code>command</code> (list of strings, optional): List of commands to run inside the container.</li> <li><code>build</code> (object, optional): Configuration for building the Docker image before running the container.</li> <li><code>context</code> (string, required): Build context path where the Dockerfile is located.</li> <li><code>args</code> (map of key-value pairs, optional): Build arguments to pass to the Docker build command.</li> </ul>"},{"location":"#ansible-vault-support","title":"Ansible Vault Support","text":"<p>nship supports Ansible Vault for secure credentials management. To decrypt a vault file, use:</p> <pre><code>nship --env-file=env.vault --vault-password=yourpassword\n</code></pre> <p>The VAULT_PASSWORD environment variable can also be used to provide the password for decrypting Ansible Vault files, allowing for more secure automation workflows.</p> <p>If both --vault-password and the VAULT_PASSWORD environment variable are missing, the tool will prompt for the password in the terminal.</p>"},{"location":"#skipping-unchanged-steps","title":"Skipping Unchanged Steps","text":"<p>By default, nship skips execution of unchanged steps to optimize performance. Use <code>--no-skip</code> to disable this behavior.</p>"},{"location":"#contributing","title":"Contributing","text":"<p>Contributions are welcome! Feel free to submit issues and pull requests.</p>"},{"location":"#license","title":"License","text":"<p>This project is licensed under the MIT License.</p>"}]}